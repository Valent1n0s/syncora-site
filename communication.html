<!DOCTYPE html>

<html lang="uk">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Комунікація — SyncOra</title>
<!-- Підключення шрифтів і стилів -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&amp;family=Urbanist:wght@400;600;800&amp;display=swap" rel="stylesheet"/>
<link href="style.css" rel="stylesheet"/>
<!-- Вбудовані стилі для модалки -->
<!-- Скрипт перекладів і бургер-меню -->
<script>
    let currentLang = 'uk';
    const translations = {
      uk: {
        navHome:      "Головна",
        navTasks:     "Управління",
        navComm:      "Комунікація",
        navPerf:      "Продуктивність",
        navMot:       "Мотивація",
        pageTitle:    "Комунікація",
        pageSub:      "Будьте на зв'язку зі своєю командою через чати, відеоконференції та спільні документи.",
        feat1Title:   "Чат у реальному часі",
        feat1Desc:    "Спілкуйтеся без затримок за допомогою командних чатів у режимі реального часу.",
        feat2Title:   "Відеоконференції",
        feat2Desc:    "Проводьте відеозустрічі без складних налаштувань і додаткових додатків.",
        feat3Title:   "Спільна робота над документами",
        feat3Desc:    "Редагуйте документи разом, бачачи зміни одразу.",
        btnAction:    "Почати комунікацію",
        modalTitle:   "Нова комунікація",
        modalTopic:   "Тема розмови",
        modalType:    "Тип комунікації",
        modalChat:    "Чат",
        modalVideo:   "Відеоконференція",
        modalSubmit:  "Розпочати",
        footerText:   "© 2025 SyncOra. Всі права захищені."
      },
      en: {
        navHome:      "Home",
        navTasks:     "Management",
        navComm:      "Communication",
        navPerf:      "Performance",
        navMot:       "Motivation",
        pageTitle:    "Communication",
        pageSub:      "Stay connected with your team via chats, video calls and shared docs.",
        feat1Title:   "Real-time Chat",
        feat1Desc:    "Talk instantly with team chats in real time.",
        feat2Title:   "Video Conferencing",
        feat2Desc:    "Host video meetings without complex setup or extra apps.",
        feat3Title:   "Document Collaboration",
        feat3Desc:    "Edit documents together and see updates instantly.",
        btnAction:    "Start Communication",
        modalTitle:   "New Communication",
        modalTopic:   "Conversation Topic",
        modalType:    "Communication Type",
        modalChat:    "Chat",
        modalVideo:   "Video Call",
        modalSubmit:  "Start",
        footerText:   "© 2025 SyncOra. All rights reserved."
      }
    };

    function applyLanguage(lang) {
      const t = translations[lang];
      if (!t) return;
      currentLang = lang;

      // Навігація
      const nav = document.querySelectorAll('.navigation ul li a');
      nav[0].innerText = t.navHome;
      nav[1].innerText = t.navTasks;
      nav[2].innerText = t.navComm;
      nav[3].innerText = t.navPerf;
      nav[4].innerText = t.navMot;

      // Заголовок
      document.querySelector('.page-title h1').innerText = t.pageTitle;
      document.querySelector('.page-title p').innerText = t.pageSub;

      // Фічі
      const feats = document.querySelectorAll('.communication-feature');
      feats.forEach((el, i) => {
        el.querySelector('h3').innerText = t[`feat${i+1}Title`];
        el.querySelector('p').innerText  = t[`feat${i+1}Desc`];
      });

      // Кнопка дії
      document.querySelector('.communication-action .btn-large').innerText = t.btnAction;

      // Модалка
      document.querySelector('#communicationModal h2').innerText          = t.modalTitle;
      document.getElementById('chatTopic').placeholder                   = t.modalTopic;
      const sel = document.getElementById('communicationType');
      sel.options[0].text = t.modalType;
      sel.options[1].text = t.modalChat;
      sel.options[2].text = t.modalVideo;
      document.querySelector('#communicationForm button').innerText      = t.modalSubmit;

      // Футер
      document.querySelector('footer p').innerText = t.footerText;

      // Перемикач мови
      document.getElementById('lang-toggle').innerText = (lang==='uk'?'Укр':'En');
    }

    document.addEventListener('DOMContentLoaded', () => {
      applyLanguage(currentLang);

      // Перемикач мови
      document.getElementById('lang-toggle')
        .addEventListener('click', () => applyLanguage(currentLang==='uk'?'en':'uk'));

      // Бургер-меню
      document.querySelector('.menu-toggle')
        .addEventListener('click', () => {
          document.querySelector('.navigation ul').classList.toggle('show');
        });
    });
  </script>
<!-- AOS CSS -->
<link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet"/>
<style>
  body {
    margin: 0;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
    background: linear-gradient(to bottom, #f5f7fa, #ffffff);
    color: #111;
  }
  .page-header {
    background: url('images/communication-background.jpg') no-repeat center center fixed;
    background-size: cover;
  }
  h1, h2, h3 {
    font-weight: 700;
    text-align: center;
    color: #111;
  }
  button, .btn, .btn-large {
    background: #007aff;
    color: white;
    padding: 12px 20px;
    border: none;
    border-radius: 10px;
    font-weight: 600;
    font-size: 16px;
    cursor: pointer;
    box-shadow: 0 4px 14px rgba(0, 122, 255, 0.3);
    transition: background 0.3s ease;
  }
  button:hover, .btn:hover {
    background: #005fce;
  }
  input, select, textarea {
    padding: 10px;
    margin-bottom: 12px;
    border: 1px solid #ccc;
    border-radius: 10px;
    font-size: 16px;
    width: 100%;
    box-sizing: border-box;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    background: #fff;
    border-radius: 10px;
    overflow: hidden;
    box-shadow: 0 4px 16px rgba(0,0,0,0.06);
  }
  table th, table td {
    padding: 14px 16px;
    text-align: left;
    border-bottom: 1px solid #eee;
  }
  table th {
    background: #f9fafb;
  }
  table tr:hover {
    background: #f1f3f5;
  }
  #meetingScheduler {
    padding: 40px;
    background: #fff;
    border-radius: 16px;
    max-width: 800px;
    margin: 40px auto;
    box-shadow: 0 6px 20px rgba(0,0,0,0.04);
  }
</style>

<script>
  const user = JSON.parse(localStorage.getItem('loggedInUser'));
  if (!user) window.location.href = 'login.html';
</script>

</head>
<body data-page="communication">
<!-- Header -->
<header class="site-header">
<div class="nav">
<div class="logo">
<a href="index.html"><img alt="SyncOra Logo" src="images/logo.png"/></a>
</div>
<div aria-label="Toggle menu" class="menu-toggle">
<span></span><span></span><span></span>
</div>
<nav class="navigation">
<ul>
<li><a href="index.html">Головна</a></li>
<li><a href="tasks.html">Управління</a></li>
<li><a class="active" href="communication.html">Комунікація</a></li>
<li><a href="performance.html">Продуктивність</a></li>
<li><a href="motivation.html">Мотивація</a></li>
</ul>
</nav>
<div class="controls">
<button class="lang-toggle" id="lang-toggle" style="color: #111; font-weight: 500;">Укр</button>
</div>
</div>
</header>
<!-- Hero -->
<section class="page-header" style="background-image: url('images/communication-background.jpg');">
<div class="page-title" data-aos="fade-up">
<h1>Комунікація</h1>
<p class="page-subtitle">Будьте на зв'язку зі своєю командою через чати, відеоконференції та спільні документи.</p>
</div>
</section>
<!-- Features -->
<main id="communication">
<section class="communication-features" data-aos="fade-up">
<div class="communication-feature" data-aos="zoom-in">
<h3>Чат у реальному часі</h3>
<p>Спілкуйтеся без затримок за допомогою командних чатів у режимі реального часу.</p>
</div>
<div class="communication-feature" data-aos="zoom-in" data-aos-delay="100">
<h3>Відеоконференції</h3>
<p>Проводьте відеозустрічі без складних налаштувань і додаткових додатків.</p>
</div>
<div class="communication-feature" data-aos="zoom-in" data-aos-delay="200">
<h3>Спільна робота над документами</h3>
<p>Редагуйте документи разом, бачачи зміни одразу.</p>
</div>
</section>
<div class="communication-action" data-aos="fade-up">
<a class="btn-large" href="#" id="openCommBtn">Почати комунікацію</a>
</div>
</main>
<!-- Modal -->
<div class="modal" id="communicationModal">
<div class="modal-content" data-aos="zoom-in">
<span class="close">×</span>
<h2>Нова комунікація</h2>
<form id="communicationForm">
<input id="chatTopic" placeholder="Тема розмови" required="" type="text"/>
<select id="communicationType" required="">
<option value="">Тип комунікації</option>
<option value="chat">Чат</option>
<option value="video">Відеоконференція</option>
</select>
<button class="btn" type="submit">Розпочати</button>
</form>

<div style="text-align:center; margin-top: 20px;">
  <button id="googleCalendarBtn" type="button" style="padding: 10px 20px; background: #4285F4; color: white; border: none; border-radius: 8px; font-weight: 600;">
    Додати до Google Calendar
  </button>
</div>

</div>
</div>
<!-- Footer -->

<div style="display: flex; justify-content: center; align-items: flex-start; gap: 40px; max-width: 1200px; margin: 60px auto; flex-wrap: wrap;"><div style="flex: 1;"><section id="meetingScheduler" style="margin: 40px 20px;">
<h2 style="text-align:center;">Планувальник зустрічей</h2>
<form id="meetingForm" style="margin: 40px auto; display: grid; gap: 16px; grid-template-columns: 1fr 1fr; max-width: 700px;background: white; padding: 40px; border-radius: 16px; box-shadow: 0 12px 32px rgba(0,0,0,0.1);">
<input id="meetingTopic" placeholder="Тема зустрічі" required="" style="width: 100%;" type="text"/>
<input id="meetingAction" placeholder="Дія" required="" style="width: 100%;" type="text"/><input id="meetingDate" required="" style="width: 100%;" type="date"/>
<input id="meetingContact" placeholder="Контакт (email або ім’я)" required="" style="width: 100%;" type="text"/>
<button style="grid-column: span 2;" type="submit">Додати зустріч</button>
</form>

<div style="text-align:center; margin-top: 20px;">
  <button id="googleCalendarBtn" type="button" style="padding: 10px 20px; background: #4285F4; color: white; border: none; border-radius: 8px; font-weight: 600;">
    Додати до Google Calendar
  </button>
</div>

<table border="1" style="width:100%;max-width:800px;margin:auto;border-collapse:collapse;">
<thead>
<tr style="background:#f0f0f0;">
<th>Тема</th><th>Дата</th><th>Контакт</th><th>Дії</th>
</tr>
</thead>
<tbody id="meetingTable"></tbody>
</table>
</section></div><div style="flex: 1;">
<div style="background:#fff;padding:40px;border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,0.05);text-align:center;">
<h3>Інформація</h3>
<p>Зустрічі — це ключ до синхронізації команди. Додайте події, дію та контактну особу для зручного планування.</p>
<img alt="Calendar" src="images/calendar.png" style="max-width:80%;margin-top:20px;"/>
</div>
</div></div><footer>
<p>© 2025 SyncOra. Всі права захищені.</p>

<section style="text-align:center; padding:40px;">
  <h2>Відеозустріч SyncOra</h2>
  <p>Нижче вікно відеозвʼязку Jitsi Meet для вашої команди</p>
  <iframe src="https://meet.jit.si/syncora_demo_room"
          allow="camera; microphone; fullscreen; display-capture"
          style="width:100%; max-width:800px; height:500px; border:1px solid #ccc; border-radius:12px;">
  </iframe>
</section>

</footer>
<!-- Скрипти -->
<script src="lang.js"></script>
<script type="module" src="firebase-config.js"></script>
<script type="module" src="script.js"></script>
<script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
<script>
function loadMeetings() {
  const table = document.getElementById('meetingTable');
  table.innerHTML = '';
  const meetings = JSON.parse(localStorage.getItem('meetings')) || [];
  meetings.forEach((m, i) => {
    const row = document.createElement('tr');
    row.innerHTML = `<td>${m.topic}</td><td>${m.date}</td><td>${m.contact}</td>
    <td><button onclick="deleteMeeting(${i})" style="padding:4px 8px;background:#ff4d4f;color:white;border:none;border-radius:6px;">✕</button></td>`;
    table.appendChild(row);
  });
}
function saveMeeting(meeting) {
  const meetings = JSON.parse(localStorage.getItem('meetings')) || [];
  meetings.push(meeting);
  localStorage.setItem('meetings', JSON.stringify(meetings));
  loadMeetings();
}
function deleteMeeting(index) {
  const meetings = JSON.parse(localStorage.getItem('meetings')) || [];
  meetings.splice(index, 1);
  localStorage.setItem('meetings', JSON.stringify(meetings));
  loadMeetings();
}
document.getElementById('meetingForm').addEventListener('submit', e => {
  e.preventDefault();
  const topic = document.getElementById('meetingTopic').value;
  const date = document.getElementById('meetingDate').value;
  const contact = document.getElementById('meetingContact').value;
  saveMeeting({ topic, date, contact });
  e.target.reset();
});
document.addEventListener('DOMContentLoaded', loadMeetings);
</script><script>
    // Ініціалізація AOS
    AOS.init({ duration: 1000, once: true });

    // Open/close communication modal
    const openBtn = document.getElementById('openCommBtn');
    const modal   = document.getElementById('communicationModal');
    const closeX  = modal.querySelector('.close');

    openBtn.addEventListener('click', e => {
      e.preventDefault();
      modal.style.display = 'flex';
    });
    closeX.addEventListener('click', () => modal.style.display = 'none');
    window.addEventListener('click', e => {
      if (e.target === modal) modal.style.display = 'none';
    });
  </script>

<!-- Панель чату -->
<section style="max-width:800px;margin:60px auto;text-align:center;">
  <h2>Чат команди</h2>
  <div id="chatBox" style="border:1px solid #ccc;border-radius:10px;padding:20px;height:300px;overflow-y:auto;text-align:left;background:#fafafa;"></div>
  <input id="chatInput" type="text" placeholder="Повідомлення" style="width:70%;padding:10px;border-radius:8px;border:1px solid #ccc;margin-top:10px;" />
  <button onclick="sendMessage()" class="btn-large">📨 Надіслати</button>
</section>
<script>
function sendMessage() {
  const msg = document.getElementById('chatInput').value.trim();
  if (!msg) return;
  const box = document.getElementById('chatBox');
  const div = document.createElement('div');
  div.textContent = '🗨️ ' + msg;
  div.style.marginBottom = '8px';
  box.appendChild(div);
  localStorage.setItem('chat_' + Date.now(), msg);
  document.getElementById('chatInput').value = '';
  box.scrollTop = box.scrollHeight;
}
document.addEventListener('DOMContentLoaded', () => {
  const box = document.getElementById('chatBox');
  Object.keys(localStorage)
    .filter(k => k.startsWith('chat_'))
    .sort()
    .forEach(k => {
      const div = document.createElement('div');
      div.textContent = '🗨️ ' + localStorage.getItem(k);
      div.style.marginBottom = '8px';
      box.appendChild(div);
    });
});
</script>

<!-- Відеозустріч Jitsi -->
<!-- Видалено дубль відеозустрічі -->
  <iframe src="https://meet.jit.si/SyncOraRoom" style="width:100%;height:400px;border:0;border-radius:12px;" allow="camera; microphone; fullscreen"></iframe>
</section>

<!-- Статистика повідомлень -->
<section style="text-align:center;margin:40px auto;">
  <h2>Кількість повідомлень</h2>
  <p id="messageCount" style="font-size:24px;"></p>
</section>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const count = Object.keys(localStorage).filter(k => k.startsWith('chat_')).length;
  document.getElementById('messageCount').textContent = `Усього: ${count}`;
});
</script>

<!-- Експорт чату -->
<section style="text-align:center;margin:40px auto;">
  <button class="btn-large" onclick="exportChat()">📤 Експортувати чат</button>
</section>
<script>
function exportChat() {
  const chats = Object.keys(localStorage).filter(k => k.startsWith('chat_')).sort();
  const content = chats.map(k => localStorage.getItem(k)).join('\n');
  const blob = new Blob([content], { type: 'text/plain' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'chat_log.txt';
  a.click();
}
</script>

<!-- Push-нагадування -->
<script>
function notifyComm() {
  alert('🔔 Нагадування про зустріч надіслано!');
}
</script>
<section style="text-align:center;margin:40px auto;">
  <button class="btn-large" onclick="notifyComm()">🔔 Надіслати нагадування</button>
</section>

<!-- Озвучення повідомлення -->
<section style="text-align:center;margin:40px auto;">
  <button class="btn-large" onclick="readLatest()">🎤 Озвучити останнє</button>
</section>
<script>
function readLatest() {
  const chats = Object.keys(localStorage).filter(k => k.startsWith('chat_')).sort();
  const last = localStorage.getItem(chats[chats.length-1]) || 'Немає повідомлень';
  const msg = new SpeechSynthesisUtterance(last);
  msg.lang = 'uk-UA';
  window.speechSynthesis.speak(msg);
}
</script>

<!-- Темна тема -->
<section style="text-align:center;margin:40px auto;">
  <button class="btn-large" onclick="document.body.classList.toggle('dark-theme')">🌙 Темна тема</button>
</section>
<style>
.dark-theme { background:#111;color:#fff; }
.dark-theme input, .dark-theme textarea { background:#222;color:#fff; }
.dark-theme #chatBox { background:#222; }
</style>


<!-- Активність по днях -->
<section style="max-width:800px;margin:60px auto;">
  <h2 style="text-align:center;">Активність комунікацій</h2>
  <canvas id="chatActivity" height="200"></canvas>
</section>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const ctx = document.getElementById('chatActivity').getContext('2d');
  const messages = Object.keys(localStorage).filter(k => k.startsWith('chat_'));
  const byDate = {};
  messages.forEach(k => {
    const d = new Date(parseInt(k.split('_')[1])).toISOString().slice(0, 10);
    byDate[d] = (byDate[d] || 0) + 1;
  });

  new Chart(ctx, {
    type: 'bar',
    data: {
      labels: Object.keys(byDate),
      datasets: [{
        label: 'Повідомлень',
        data: Object.values(byDate),
        backgroundColor: '#0077ff'
      }]
    },
    options: {
      responsive: true,
      scales: { y: { beginAtZero: true } }
    }
  });
});
</script>

<!-- SVG комунікаційний сигнал -->
<!-- SVG сигнал видалено -->
  <svg width="200" height="80" viewBox="0 0 200 80">
    <polyline points="0,40 40,20 80,60 120,30 160,50 200,10" 
              fill="none" stroke="#00c853" stroke-width="4">
      <animate attributeName="points" dur="3s" repeatCount="indefinite"
        values="0,40 40,20 80,60 120,30 160,50 200,10;
                0,30 40,40 80,30 120,60 160,20 200,40;
                0,40 40,20 80,60 120,30 160,50 200,10"/>
    </polyline>
  </svg>
</section>

<!-- Canvas ефект -->
<!-- Canvas видалено -->
  <canvas id="commCanvas" width="300" height="100" style="border:1px solid #ccc;"></canvas>
</section>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const canvas = document.getElementById('commCanvas');
  const ctx = canvas.getContext('2d');
  let x = 0;
  setInterval(() => {
    ctx.clearRect(0,0,300,100);
    ctx.beginPath();
    ctx.moveTo(0, 50);
    for (let i = 0; i < 300; i++) {
      ctx.lineTo(i, 50 + Math.sin((i + x)/10)*10);
    }
    ctx.strokeStyle = '#42a5f5';
    ctx.stroke();
    x += 3;
  }, 80);
});
</script>

<!-- Календар зустрічей -->
<section style="max-width:800px;margin:60px auto;text-align:center;">
  <h2>Календар зустрічей</h2>
  <input type="date" id="meetingDate" style="padding:10px;border-radius:8px;border:1px solid #ccc;" />
  <button onclick="saveMeeting()" class="btn-large">➕ Додати</button>
  <ul id="meetingList" style="margin-top:20px;"></ul>
</section>
<script>
function saveMeeting() {
  const date = document.getElementById('meetingDate').value;
  if (!date) return;
  const all = JSON.parse(localStorage.getItem('meetings') || '[]');
  all.push(date);
  localStorage.setItem('meetings', JSON.stringify(all));
  renderMeetings();
}
function renderMeetings() {
  const list = JSON.parse(localStorage.getItem('meetings') || '[]');
  const ul = document.getElementById('meetingList');
  ul.innerHTML = '';
  list.forEach(d => {
    const li = document.createElement('li');
    li.textContent = '📅 ' + d;
    ul.appendChild(li);
  });
}
document.addEventListener('DOMContentLoaded', renderMeetings);
</script>

<!-- Фідбек -->
<section style="text-align:center;margin:60px auto;">
  <h2>Зворотний зв’язок</h2>
  <textarea id="commFeedback" placeholder="Напишіть відгук..." rows="4" style="width:90%;max-width:500px;padding:10px;border-radius:10px;"></textarea><br/>
  <button class="btn-large" onclick="saveCommFeedback()">Надіслати</button>
</section>
<script>
function saveCommFeedback() {
  const val = document.getElementById('commFeedback').value.trim();
  if (val) {
    localStorage.setItem('comm_feedback_' + Date.now(), val);
    alert('Дякуємо за відгук!');
    document.getElementById('commFeedback').value = '';
  }
}
</script>

<!-- Пасхалка -->
<script>
document.addEventListener('keydown', e => {
  if (e.key === '7') alert('🎉 Пасхалка! Комунікація — ключ до синергії!');
});
</script>


<!-- Голосовий чат (заглушка) -->
<section style="text-align:center;margin:60px auto;">
  <h2>🔊 Голосовий чат (демо)</h2>
  <button class="btn-large" onclick="alert('🎙️ Створення голосового каналу... (демо)')">🎧 Увімкнути мікрофон</button>
</section>

<!-- Рейтинг учасників -->
<section style="max-width:800px;margin:60px auto;text-align:center;">
  <h2>Рейтинг активних співрозмовників</h2>
  <div id="commRating"></div>
</section>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const chats = Object.keys(localStorage).filter(k => k.startsWith('chat_'));
  const rating = {};
  chats.forEach(k => {
    const content = localStorage.getItem(k);
    const name = content.split(':')[0] || 'анонім';
    rating[name] = (rating[name] || 0) + 1;
  });
  const sorted = Object.entries(rating).sort((a,b)=>b[1]-a[1]);
  const container = document.getElementById('commRating');
  container.innerHTML = sorted.map(([name, count]) => `<p>${name} — ${count} повідомлень</p>`).join('');
});
</script>

<!-- Режим доповідача -->
<section style="text-align:center;margin:60px auto;">
  <button class="btn-large" onclick="toggleSpeakerMode()">🎙️ Режим доповідача</button>
</section>
<script>
function toggleSpeakerMode() {
  const chat = document.getElementById('chatBox');
  chat.style.fontSize = chat.style.fontSize === '26px' ? '16px' : '26px';
  chat.style.lineHeight = chat.style.lineHeight === '1.8' ? '1.2' : '1.8';
}
</script>

<!-- PDF лог повідомлень -->
<section style="text-align:center;margin:60px auto;">
  <button class="btn-large" onclick="downloadChatLogPDF()">📄 Завантажити PDF чат</button>
</section>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
async function downloadChatLogPDF() {
  const {{ jsPDF }} = window.jspdf;
  const doc = new jsPDF();
  doc.setFontSize(14);
  doc.text('Чат-лог SyncOra', 20, 20);
  const messages = Object.keys(localStorage).filter(k => k.startsWith('chat_')).sort();
  let y = 30;
  messages.forEach(k => {
    const txt = localStorage.getItem(k);
    doc.text('• ' + txt, 20, y);
    y += 10;
    if (y > 270) { doc.addPage(); y = 20; }
  });
  doc.save('chat_log.pdf');
}
</script>

</body>
</html>
