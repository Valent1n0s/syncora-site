<!DOCTYPE html>

<html lang="uk"><head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å ‚Äî SyncOra</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;800&amp;family=Urbanist:wght@400;600;800&amp;display=swap" rel="stylesheet"/>
<link href="style.css" rel="stylesheet"/>
<link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
<script>AOS.init({ duration: 1000, once: true });</script>
<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
  background: linear-gradient(to bottom, #f2f4f7, #ffffff);
  color: #111;
  margin: 0;
  padding: 0;
}
.page-header {
  background-image: url('images/performance-background.jpg');
  background-size: cover;
  background-position: center;
  padding: 80px 20px;
  color: #fff;
  text-align: center;
}
main {
  background: transparent;
}
.report-item {
  background: #fff;
  padding: 20px;
  margin-bottom: 16px;
  border-radius: 12px;
  box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  transition: transform 0.2s ease;
}
.report-item:hover {
  transform: translateY(-4px);
}
.btn-large {
  background: #007aff;
  color: white;
  padding: 12px 24px;
  font-size: 16px;
  font-weight: 600;
  border: none;
  border-radius: 12px;
  cursor: pointer;
  box-shadow: 0 4px 14px rgba(0,122,255,0.3);
  transition: background 0.3s ease;
}
.btn-large:hover {
  background: #005fce;
}
</style></head><body data-page="performance">
<header class="site-header">
<div class="nav">
<div class="logo"><a href="index.html"><img alt="SyncOra Logo" src="images/logo.png"/></a></div>
<div class="menu-toggle"><span></span><span></span><span></span></div>
<nav class="navigation">
<ul>
<li><a href="index.html">–ì–æ–ª–æ–≤–Ω–∞</a></li>
<li><a href="tasks.html">–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è</a></li>
<li><a href="communication.html">–ö–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—è</a></li>
<li><a class="active" href="performance.html">–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å</a></li>
<li><a href="motivation.html">–ú–æ—Ç–∏–≤–∞—Ü—ñ—è</a></li>
</ul>
</nav>
<div class="controls">
<button class="lang-toggle" id="lang-toggle">–£–∫—Ä</button>
<a class="auth-btn" href="login.html" id="userAction">–£–≤—ñ–π—Ç–∏</a>
</div>
</div>
</header>
<section class="page-header" style="background-image: url('images/performance-background.jpg');">
<div class="page-title" data-aos="fade-up">
<h1>–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å</h1>
<p>–ê–Ω–∞–ª—ñ–∑ –µ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –∫–æ–º–∞–Ω–¥–∏: –≥—Ä–∞—Ñ—ñ–∫–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ, —Ä–µ–π—Ç–∏–Ω–≥–∏, –∑–≤–µ–¥–µ–Ω—ñ –∑–≤—ñ—Ç–∏.</p>
</div>
</section>
<main id="performance">
<section class="performance-chart" style="max-width:800px;margin:60px auto;">
<h2 style="text-align:center;">–ì—Ä–∞—Ñ—ñ–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –ø–æ –¥–Ω—è—Ö</h2>
<canvas height="200" id="dailyChart"></canvas>
</section>
<section class="performance-rating" style="max-width:1000px;margin:60px auto;">
<h2 style="text-align:center;">–†–µ–π—Ç–∏–Ω–≥ —É—á–∞—Å–Ω–∏–∫—ñ–≤</h2>
<table style="width:100%;border-collapse:collapse;text-align:left;">
<thead>
<tr style="background:#f0f0f0;">
<th style="padding:10px;">–ö–æ—Ä–∏—Å—Ç—É–≤–∞—á</th>
<th style="padding:10px;">–ë–∞–ª–∏</th>
<th style="padding:10px;">–ë–µ–π–¥–∂</th>
<th style="padding:10px;">–ü—Ä–æ–≥—Ä–µ—Å</th>
</tr>
</thead>
<tbody id="performanceStats"></tbody>
</table>
</section>
<section class="report-list" style="max-width:1000px;margin:60px auto;">
<h2>–í–∞—à—ñ –∑–≤—ñ—Ç–∏</h2>
<ul id="reportsContainer" style="list-style:none;padding:0;"></ul>
</section>
<div class="export-controls" style="text-align:center;margin-top:24px;">
<button class="btn-large" onclick="exportData('json')" style="margin-right:10px;">–ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ JSON</button>
<button class="btn-large" onclick="exportData('csv')">–ï–∫—Å–ø–æ—Ä—Ç—É–≤–∞—Ç–∏ CSV</button>
</div>
<section style="max-width:800px;margin:60px auto;text-align:center;">
<h2>–ü—ñ–¥—Å—É–º–∫–∏ –º—ñ—Å—è—Ü—è</h2>
<p id="monthlySummary" style="font-weight:bold;font-size:20px;"></p>
</section>
<section style="max-width:800px;margin:60px auto;text-align:center;">
<h2>–§—ñ–ª—å—Ç—Ä –ø–æ –º—ñ—Å—è—Ü—é</h2>
<input id="monthFilter" style="padding:10px;border-radius:8px;border:1px solid #ccc;" type="month"/>
<button class="btn-large" onclick="filterByMonth()">–§—ñ–ª—å—Ç—Ä—É–≤–∞—Ç–∏</button>
</section>
<section style="max-width:900px;margin:60px auto;">
<h2 style="text-align:center;">–Ü—Å—Ç–æ—Ä—ñ—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–µ–π</h2>
<ul id="activityHistory" style="list-style:none;padding:0;"></ul>
</section>
<section style="max-width:1000px;margin:60px auto;text-align:center;">
<h2>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–æ–º–∞–Ω–¥</h2>
<table style="width:100%;border-collapse:collapse;margin-top:20px;">
<thead>
<tr style="background:#f0f0f0;"><th>–ö–æ–º–∞–Ω–¥–∞</th><th>–£—á–∞—Å–Ω–∏–∫—ñ–≤</th><th>–ó–≤—ñ—Ç—ñ–≤</th></tr>
</thead>
<tbody id="teamStats"></tbody>
</table>
</section>
</main>
<footer><p>¬© 2025 SyncOra. –í—Å—ñ –ø—Ä–∞–≤–∞ –∑–∞—Ö–∏—â–µ–Ω—ñ.</p></footer>
<script>
document.addEventListener('DOMContentLoaded', () => {
  const reports = JSON.parse(localStorage.getItem('reports')) || [];
  const currentUser = JSON.parse(localStorage.getItem('loggedInUser'))?.email || '–Ω–µ–≤—ñ–¥–æ–º–æ';

  // –ì—Ä–∞—Ñ—ñ–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –ø–æ –¥–Ω—è—Ö
  const dailyCtx = document.getElementById('dailyChart').getContext('2d');
  const dayCounts = {};
  reports.forEach(r => {
    const date = r.deadline || '–Ω–µ–≤—ñ–¥–æ–º–æ';
    dayCounts[date] = (dayCounts[date] || 0) + 1;
  });
  new Chart(dailyCtx, {
    type: 'bar',
    data: {
      labels: Object.keys(dayCounts),
      datasets: [{ label: '–ó–≤—ñ—Ç—ñ–≤ –Ω–∞ –¥–µ–Ω—å', data: Object.values(dayCounts), backgroundColor: '#0077ff' }]
    },
    options: { responsive: true, scales: { y: { beginAtZero: true } } }
  });

  // –†–µ–π—Ç–∏–Ω–≥
  const userStats = {};
  reports.forEach(r => {
    const email = r.email || '–Ω–µ–≤—ñ–¥–æ–º–æ';
    userStats[email] = userStats[email] || { count: 0 };
    userStats[email].count += 1;
  });
  const statBody = document.getElementById('performanceStats');
  for (const [email, stat] of Object.entries(userStats)) {
    const badge = stat.count >= 10 ? 'üèÜ' : stat.count >= 5 ? 'üéñÔ∏è' : '‚≠ê';
    const row = document.createElement('tr');
    row.innerHTML = `<td style="padding:10px;">${email}</td><td style="padding:10px;">${stat.count * 10}</td><td style="padding:10px;">${badge}</td>
      <td style="padding:10px;"><div style="background:#eee;width:100%;height:14px;border-radius:8px;">
      <div style="background:#0077ff;width:${Math.min(stat.count * 10, 100)}%;height:100%;"></div></div></td>`;
    statBody.appendChild(row);
  }

  // –ó–≤—ñ—Ç–∏ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞
  const reportsContainer = document.getElementById('reportsContainer');
  const filtered = reports.filter(r => r.email === currentUser);
  filtered.forEach(r => {
    const li = document.createElement('li');
    li.className = 'report-item';
    li.style = 'background:#fff;padding:20px;border-radius:12px;margin-bottom:10px;box-shadow:0 2px 8px rgba(0,0,0,0.05);';
    li.innerHTML = `<h3>${r.title}</h3><p>${r.desc}</p><p><strong>–î–µ–¥–ª–∞–π–Ω:</strong> ${r.deadline}</p>`;
    reportsContainer.appendChild(li);
  });

  // –Ü—Å—Ç–æ—Ä—ñ—è –æ—Å—Ç–∞–Ω–Ω—ñ—Ö 10
  const history = document.getElementById('activityHistory');
  reports.slice(-10).reverse().forEach(r => {
    const li = document.createElement('li');
    li.textContent = `[${r.deadline}] ${r.title} ‚Äî ${r.desc}`;
    li.style = 'background:#f9f9f9;padding:12px;border-radius:8px;margin-bottom:10px;';
    history.appendChild(li);
  });

  // –ö–æ–º–∞–Ω–¥–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
  const teams = {};
  reports.forEach(r => {
    const t = r.team || '–Ü–Ω—à—ñ';
    teams[t] = teams[t] || { members: new Set(), count: 0 };
    teams[t].members.add(r.email);
    teams[t].count++;
  });
  const teamTable = document.getElementById('teamStats');
  Object.entries(teams).forEach(([team, obj]) => {
    const tr = document.createElement('tr');
    tr.innerHTML = `<td>${team}</td><td>${obj.members.size}</td><td>${obj.count}</td>`;
    teamTable.appendChild(tr);
  });

  // –ü—ñ–¥—Å—É–º–∫–∏ –º—ñ—Å—è—Ü—è
  const thisMonth = new Date().toISOString().slice(0, 7);
  const monthlyCount = reports.filter(r => r.deadline?.slice(0,7) === thisMonth).length;
  document.getElementById('monthlySummary').textContent = `–£ —Ü—å–æ–º—É –º—ñ—Å—è—Ü—ñ —Å—Ç–≤–æ—Ä–µ–Ω–æ ${monthlyCount} –∑–≤—ñ—Ç—ñ–≤.`;
});

function filterByMonth() {
  const selected = document.getElementById('monthFilter').value;
  if (!selected) return alert('–û–±–µ—Ä—ñ—Ç—å –º—ñ—Å—è—Ü—å');
  const container = document.getElementById('reportsContainer');
  const data = JSON.parse(localStorage.getItem('reports')) || [];
  container.innerHTML = '';
  data.filter(r => r.deadline?.slice(0, 7) === selected).forEach(r => {
    const li = document.createElement('li');
    li.className = 'report-item';
    li.innerHTML = `<h3>${r.title}</h3><p>${r.desc}</p><p><strong>–î–µ–¥–ª–∞–π–Ω:</strong> ${r.deadline}</p>`;
    container.appendChild(li);
  });
}

function exportData(format) {
  const user = JSON.parse(localStorage.getItem('loggedInUser'));
  if (!user) return alert("–°–ø–æ—á–∞—Ç–∫—É —É–≤—ñ–π–¥—ñ—Ç—å —É –∞–∫–∞—É–Ω—Ç.");
  const raw = JSON.parse(localStorage.getItem('reports')) || [];
  const data = raw.filter(r => r.email === user.email);
  const filename = `reports_${user.email.replace(/[@.]/g, '_')}.${format}`;
  if (format === 'json') {
    const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
    downloadBlob(blob, filename);
  } else if (format === 'csv') {
    const headers = Object.keys(data[0] || {});
    const rows = data.map(r => headers.map(k => JSON.stringify(r[k] || '')).join(','));
    const csv = [headers.join(','), ...rows].join('\n');
    const blob = new Blob([csv], { type: 'text/csv' });
    downloadBlob(blob, filename);
  }
}
function downloadBlob(blob, filename) {
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = filename;
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}
</script>
</body></html>